<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Access-Control-Allow-Origin:*" content="text/html; charset=utf-8" />
<title>World Economy</title>
<!-- 引入 echarts.js -->
<script src="./static/js/echarts.js"></script>
<script src="./static/js/world.js"></script>
<link rel="stylesheet" href="./static/css/main.css">  
<script type="text/javascript" src="./static/js/jquery-3.4.1.min.js"></script> 
<!-- multiple-select.js -->
<link rel="stylesheet" href="https://unpkg.com/multiple-select@1.5.2/dist/multiple-select.min.css">
<script src="https://unpkg.com/multiple-select@1.5.2/dist/multiple-select.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

    <div class='title'>INVIS 区域电信网数据可视化系统</div>
    <div class="main-panel">
        <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
        <div id="filter" style="width: 330px;">
            <!-- <select id="countries" class="j-chosen" data-live-search="true" multiple="multiple"></select> -->
            <select id="countries" data-placeholder="Choose a Country..." multiple="multiple="></select>
        </div>
        <div class="left">
            <div >
                <ul class='nav nav-tabs' id='nav_tabs'>
                    <li class="active tabs" id="nav_operator"><a class="tabs_inner">运营商商业关系</a></li>
                    <li id="nav_device_connect" class="tabs"><a class="tabs_inner">通信连接结构</a></li>
                    <!-- <li ><a href="#">设备运行风险分析</a></li> -->
                </ul>
                <div style='height:600px;width:100%'>
                    <div id='operator' style='display: block'></div>
                    <div id="main" style='display: none'></div>
                </div>

            </div>
            <div id='statisticP' >
                <div id = 'countryName' style="width:100%"></div>
                <div style='display: flex;'>
                    <div id='Cpie' class="staview"></div>
                    <div id='Lchart' class="staview"></div>
                    <div id='operatorchart' class="staview"></div>
               </div>
                <div class="layer barchart">
                    <div class="layerTitle">
                        <i class="arrow" onclick="hideAndShow(this)"></i>进出口差值与GDP比值
                    </div>
                    <div class=" sencondLayer inputSlider">
                        <div id="barchart" style="width:100%;height:300px;"></div>
                    </div>
                </div>
                <div class="layer parallel">
                    <div class="layerTitle">
                        <i class="arrow" onclick="hideAndShow(this)"></i>产品进/出口量
                    </div>
                    <div class=" sencondLayer inputSlider">
                        <div id="parallel" style="width:100%;height:300px;"></div>
                    </div>
                </div>

                <div class="layer BubbleChart">
                    <div class="layerTitle">
                        <i class="arrow" onclick="hideAndShow(this)"></i>人均GDP、人口、基尼指数
                    </div>
                    <div class=" sencondLayer inputSlider">
                        <div id="BubbleChart" style="width:100%; height:600px;border: 1px solid #ccc;"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class='right' id='rightpanel'>
            <div id='ispcInf' style='display: none'>
                <div class='title'> 设备详细信息</div>
                <div id='ispcInfList'></div>
            </div>
        </div>
   </div>


</body>
<script type="text/javascript" src="./static/js/nav_control.js"></script>
<script src="./static/js/drawMap.js"></script>
<script src="./static/js/BubbleChart.js"></script>
<script src="./static/js/pie.js"></script>
<script type="text/javascript">
    var pathList = {}
    var GDPList = {}
    var ContinentList = null;
    function ispc_coord(res) {
        initMapData(res)
        initMap(res)
    }
    function connect(res) {
        for(let r in res){
            let list = res[r].tolist
            list.forEach(d=>{
                if (pathList.hasOwnProperty(r)) {
                    pathList[r].path.push({ name: d.dpc, value: Number(d.value) })
                }
                else {
                    pathList[r] = {operator:res[r].operator, path: [{ name: d.dpc, value: Number(d.value) }] }
                }
            })
        }
    }
    //各个国家的各类商品的进口数据
    //[国家名，各项的值...]
    var dataIm = null;
    //各个国家的各类商品的出口数据
    var dataEx = null;

    var balance = {}
    function WtoData_imports(res) {
        dataIm = res
    }
    function WtoData_exports(res) {
        dataEx = res
    }
    function WtoData_balance(res) {
        balance = res
    }
    function GDP_Population_gini(res) {
        GDPList = res
    }
    function Get_continent(res) {
        ContinentList = res
    }
</script>
<script src="./static/data/countries.js"></script>
<script src="./static/data/ispc_coord.json?callback=ispc_coord"></script>
<script src="./static/data/tisp_connect.json?callback=connect"></script>
<script src="./static/data/WtoData_imports.json?callback=WtoData_imports"></script>
<script src="./static/data/WtoData_exports.json?callback=WtoData_exports"></script>
<script src="./static/data/2017_trade_balance_percent_of_gdp.json?callback=WtoData_balance"></script>
<script src="./static/data/GDP_Population_gini.json?callback=GDP_Population_gini"></script>
<script src="./static/data/continent.json?callback=Get_continent"></script>
<script src="./static/js/parallel_export.js"></script>
<script src="./static/js/selector.js"></script>
<script>
    function hideAndShow(e) {
        // console.log(e)
        let className = e.parentNode.parentNode.classList
        if (className.contains("active")) {
            className.remove("active")
        } else {
            className.add("active")
            if (className.contains('parallel'))
                paral();
            if (className.contains('BubbleChart'))
                GDPBubbleChart();
            if (className.contains('barchart'))
                barchart();
        }
        // console.log(p)
    }
    function renderLchart(country) {
        //{ name: r.target, value: Number(r.value) }
        // let path = pathList[country].path
        // let top5 = []
        // path.sort(function (a, b) {
        //     return b.value - a.value
        // })
        // let data = [path[4],path[3],path[2],path[1],path[0]]
        // let ldata = []
        // let l_label = []
        // for(let k of data){
        //     let v = (k.value/100000000)
        //     ldata.push(v.toFixed(2))
        //     l_label.push(k.name)
        // }

        // let radarData = null
        // for(let k of dataEx){
        //     if (country==k[0])
        //         radarData = k
        // }
        // let maxV = 0
        // let r_data = []

        // for (let k = 1; k < radarData.length; k++) {
        //     r_data.push(radarData[k])
        //     if (maxV < radarData[k])
        //         maxV = radarData[k]
        // }
        // let t = r_data[r_data.length-1]
        // r_data[r_data.length-1] = r_data[r_data.length-2]
        // r_data[r_data.length-2] = t
        // r_data = [
        //     {
        //         value: r_data,
        //         name: ''
        //     }
        // ]
        let r_label = [
            { name: '食品', max: maxV },
            { name: '燃料', max: maxV },
            { name: '铁', max: maxV },
            { name: '化学制品', max: maxV },
            { name: '机械', max: maxV },
            { name: '服装', max: maxV },
            { name: '纺织品', max: maxV }]
        // console.log(radarData,r_data)
        let l_label = ['4-121-0','4-121-4','4-128-7','4-177-1','4-178-3']//,'4-183-3','4-183-3'] 
        let ldata = ["842.23", "1095.24","1475.65", "3037.25","4806.89"]
        let r_data=[{value:[68998,35389,55756,141230,1085569,157464,109595],name:''}]
        pie(country,l_label,ldata,r_label,r_data)
   }
    var Pchart = echarts.init(document.getElementById('Cpie'));
    var Lchart = echarts.init(document.getElementById('Lchart'));
    var operatorchart =  echarts.init(document.getElementById('operatorchart'));
    // let rrr = renderLchart('China')
    // console.log(rrr)
</script>

</html>